<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ðŸ’¸ Combien vaut ton prÃ©nom ? ðŸ’¸</title>
  <style>
    body { font-family: Arial, sans-serif; background: #181818; color: #fff; text-align: center; padding: 60px; }
    input { padding: 12px; font-size: 22px; border-radius: 6px; border: none; width: 260px; }
    button { padding: 12px 35px; font-size: 22px; border-radius: 6px; background: #2ecc40; color: #fff; border: none; cursor: pointer; margin-left: 10px; }
    .result { margin-top: 35px; font-size: 32px; font-weight: bold; }
    .pop { margin-top: 12px; font-size: 17px; color: #888; }
    .footer { margin-top: 60px; color: #555; font-size: 13px; }
    #avatar { margin-top: 40px; border-radius: 50%; border: 3px solid #2ecc40; width: 120px; display: none; }
    #verdict { margin-top: 18px; font-size: 19px; font-weight: bold; }
    @media (max-width: 600px) {
      body { padding: 20px; }
      input, button { font-size: 16px; }
      .result { font-size: 24px; }
    }
  </style>
</head>
<body>
  <h1>ðŸ’¸ Valeur de ton blaze ðŸ’¸</h1>
  <input type="text" id="prenom" placeholder="Tape ton prÃ©nom...">
  <button onclick="calculePrix()">Calcule !</button>
  <div class="result" id="prix"></div>
  <div class="pop" id="pop"></div>
  <img id="avatar">
  <div id="verdict"></div>
  <div class="footer">
    <b>Source : 
      <a href="https://www.data.gouv.fr/fr/datasets/fichier-des-prenoms-depuis-1900/" 
         style="color:#2ecc40" target="_blank">data.gouv.fr</a>
    </b>
    <br>
    Projet signÃ© <b>s00r1</b> â€“ 2024
  </div>
  <script>
    function getAvatarStyle(prix) {
      if (prix >= 180) return "rings";         // Super collector
      if (prix >= 120) return "adventurer";    // StylÃ© BD
      if (prix >= 50)  return "fun-emoji";     // Fun
      return "bottts";                         // lambda/robot
    }

    function getVerdict(prix) {
      if (prix >= 180) return "ðŸ”¥ Blaze collector, tâ€™es une lÃ©gende frÃ¨re !";
      if (prix >= 120) return "ðŸ’Ž Blaze stylÃ©, respect !";
      if (prix >= 50)  return "ðŸ˜ Blaze classique, Ã§a passe crÃ¨me.";
      return "ðŸ¦¾ Blaze de robot, tâ€™es discret mais efficace.";
    }

    function calculePrix() {
      var prenom = document.getElementById('prenom').value.trim();
      var avatar = document.getElementById('avatar');
      var verdict = document.getElementById('verdict');
      if (prenom === '') {
        document.getElementById('prix').innerHTML = "Wallah, tape un prÃ©nom din'omk !";
        document.getElementById('pop').innerHTML = '';
        avatar.style.display = "none";
        verdict.innerHTML = '';
        return;
      }
      fetch('/api/prix-prenom?prenom=' + encodeURIComponent(prenom))
        .then(r => r.json())
        .then(d => {
          document.getElementById('prix').innerHTML =
            "Prix du blaze : <span style='color:#ffd700'>" + d.prix + " â‚¬</span>";
          document.getElementById('pop').innerHTML =
            (d.popularite > 0) ?
            "(PopularitÃ© : " + d.popularite + " personnes depuis 1900)" :
            "(Ce blaze est tellement rare que tâ€™es une lÃ©gende frÃ¨re)";
          // GÃ©nÃ¨re avatar adaptÃ© au prix, et ajoute random pour casser le cache
          let style = getAvatarStyle(d.prix);
          avatar.src = "https://api.dicebear.com/7.x/" + style + "/svg?seed=" + encodeURIComponent(prenom) + "&r=" + Math.random();
          avatar.style.display = "inline-block";
          verdict.innerHTML = getVerdict(d.prix);
        })
        .catch(() => {
          document.getElementById('prix').innerHTML = "Erreur serveur, la honte !";
          document.getElementById('pop').innerHTML = "";
          avatar.style.display = "none";
          verdict.innerHTML = '';
        });
    }
  </script>
</body>
</html>
